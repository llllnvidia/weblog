{% for post in posts if post %}
    <div class="well well-lg" style="background-color: rgba(255, 255, 255, 0.90)">
        {% if post.is_article %}
            {% if request.endpoint != 'main.article' %}
            <a href="{{ url_for('main.article', post_id=post.id) }}"><h3>{{ post.title }}</h3></a>
            {% else %}
            <h3>
                {{ post.title }}
                {% if post.is_article and request.endpoint == 'main.article' %}
                    {% if current_user == post.author %}
                        <a type="button" class="btn btn-warning btn-xs" href="{{ url_for('main.edit_article',post_id=post.id) }}">
                            修改
                        </a>
                    {% elif current_user.is_moderator() %}
                        <a type="button" class="btn btn-danger btn-xs" href="{{ url_for('main.edit_article',post_id=post.id) }}">
                            修改[Admin]
                        </a>
                    {% endif %}
                {% endif %}
            </h3>
            {% endif %}
            <div class="row">
            <div class="col-lg-4">
                最后一次编辑：<i style="color: gray">{{ moment(post.last_edit).fromNow() }}</i>
                <br/>
                创建时间：<i style="color: gray">{{ moment(post.timestamp).format('LL') }}</i>
                <br/>
                评论：
                {% if post.comments.count() %}
                    <i style="color: gray">{{ post.comments.count() }}</i>
                {% else %}
                    <i style="color: gray">none</i>
                {% endif %}
            </div>
            <div class="col-lg-8">
                作者：
                <a href="{{ url_for('main.user', username=post.author.username) }}" style="color: gray">
                    <i>{{ post.author.username }}</i>
                </a>
                <br/>
                栏目：
                <a href="?category={{ post.category.name }}" style="color: gray">
                    <i>{{ post.category.name }}</i>
                </a>
                <br/>
                标签：
                {% for tag in post.tags %}
                    <a href="?tag={{ tag.content }}" style="color: gray">
                    <i>{{ tag.content }}</i>
                    </a>
                {% else %}
                    无
                {% endfor %}
            </div>
            </div><br/>
            {% if request.endpoint == 'main.article' or not post.summary %}
                {{ post.body | markdown | safe}}
            {% else %}
                {{ post.summary | markdown | safe}}
            {% endif %}
            {% else %}
                {% if not request.endpoint == 'main.user' %}
                <a href="{{ url_for('main.user', username=post.author.username) }}">
                    <h3> {{ post.author.username }}
                        <small>{{ moment(post.timestamp).format('YY-MM-DD HH:mm') }}</small>
                    </h3>
                </a>
                {% else %}
                    <h3> {{ post.author.username }}
                        <small>{{ moment(post.timestamp).format('YY-MM-DD HH:mm') }}</small>
                    </h3>
                {% endif %}
            {{ post.body | markdown | safe }}
            {% endif %}
    </div>
{% else %}
    无文章
{% endfor %}